count$file<-paste(Info$File,Info$Term)
count$var<-count$word/count$sentence
count$party<-Info$Party
date<-read.csv("date.csv")
date$Date<-as.character(date$Date)
year<-substr(date$Date,nchar(date$Date)-3,nchar(date$Date))
year<-year[year!=""]
count$year<-year
count$year<-as.numeric(count$year)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var))+
geom_text(x=1942,y=20,label="ww2")+
geom_text(x=1916,y=25,label="ww1")
ggplotly(p)
ggplot(data=count[count$party=="Republican"|count$party=="Democratic",])+
geom_boxplot(mapping = aes(x=year,y=var,col=party))
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var))+
geom_text(x=1942,y=20,label="ww2")+
geom_text(x=1916,y=25,label="ww1")+
geom_text(x=1862,y=25,label="civil war")+
geom_text(x=1947,y=25,label="cold war start")+
geom_text(x=1991,y=25,label="cold war end")
ggplotly(p)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var))+
geom_text(x=1942,y=20,label="ww2")+
geom_text(x=1916,y=25,label="ww1")+
geom_text(x=1862,y=25,label="civil war")+
geom_text(x=1947,y=25,label="cold war start")+
geom_text(x=1991,y=25,label="cold war end")
ggplotly(p)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var))+
geom_text(x=1942,y=20,label="ww2")+
geom_text(x=1916,y=25,label="ww1")+
geom_text(x=1862,y=25,label="civil war")+
geom_text(x=1947,y=15,label="cold war start")+
geom_text(x=1991,y=5,label="cold war end")
ggplotly(p)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var))+
geom_text(x=1942,y=20,label="ww2")+
geom_text(x=1916,y=25,label="ww1")+
geom_text(x=1862,y=25,label="civil war")+
geom_text(x=1947,y=15,label="cold war start")+
geom_text(x=1991,y=12,label="cold war end")
ggplotly(p)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var))+
geom_text(x=1942,y=20,label="ww2")+
geom_text(x=1916,y=25,label="ww1")+
geom_text(x=1862,y=25,label="civil war")+
geom_text(x=1947,y=15,label="cold war start")+
geom_text(x=1991,y=15,label="cold war end")
ggplotly(p)
p<-ggplot(data=count[count$party=="Republican"|count$party=="Democratic",])+
geom_boxplot(mapping = aes(x=year,y=var,col=party))
ggplotly(p)
ggplot(data=count[count$party=="Republican"|count$party=="Democratic",])+
geom_boxplot(mapping = aes(x=year,y=var,col=party))
?sent_detect()
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var,col="blue"))+
geom_text(x=1942,y=20,label="ww2")+
geom_text(x=1916,y=25,label="ww1")+
geom_text(x=1862,y=25,label="civil war")+
geom_text(x=1947,y=15,label="cold war start")+
geom_text(x=1991,y=15,label="cold war end")
ggplotly(p)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var,col="red"))+
geom_text(x=1837,y=40,label="Panic 1837")+
geom_text(x=1893,y=40,label="Panic 1893")+
geom_text(x=1907,y=40,label="Panic 1907")+
geom_text(x=1929,y=40,label="wall street")+
geom_text(x=1008,y=40,label="global")
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var,col="red"))+
geom_text(x=1837,y=40,label="Panic 1837")+
geom_text(x=1893,y=40,label="Panic 1893")+
geom_text(x=1907,y=40,label="Panic 1907")+
geom_text(x=1929,y=40,label="wall street")+
geom_text(x=1008,y=40,label="global")
ggplotly(p)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var,col="red"))+
geom_text(x=1837,y=35,label="Panic 1837")+
geom_text(x=1893,y=40,label="Panic 1893")+
geom_text(x=1907,y=33,label="Panic 1907")+
geom_text(x=1929,y=25,label="wall street")+
geom_text(x=1008,y=20,label="global")
ggplotly(p)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var,col="red"))+
geom_text(x=1837,y=35,label="Panic 1837")+
geom_text(x=1893,y=40,label="Panic 1893")+
geom_text(x=1907,y=33,label="Panic 1907")+
geom_text(x=1929,y=25,label="wall street")+
geom_text(x=1008,y=20,label="global")
ggplotly(p)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var,col="red"))+
geom_text(x=1837,y=35,label="Panic 1837")+
geom_text(x=1893,y=36,label="Panic 1893")+
geom_text(x=1907,y=32,label="Panic 1907")+
geom_text(x=1929,y=22,label="wall street")+
geom_text(x=1008,y=22,label="global")
ggplotly(p)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var,col="red"))+
geom_text(x=1837,y=37,label="Panic 1837")+
geom_text(x=1893,y=36,label="Panic 1893")+
geom_text(x=1907,y=32,label="Panic 1907")+
geom_text(x=1929,y=22,label="wall street")+
geom_text(x=2008,y=22,label="global")
ggplotly(p)
library(xlsx)
library(qdap)
library(ggplot2)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx",1)
setwd("../data/InauguralSpeeches/")
count<-function(name){
n_sentence<-length(sent_detect(name))
n_word<-word_count(name)
return(c(n_sentence,n_word))
}
filename<-paste("inaug",Info$File,"-",Info$Term,".txt",collapse = NULL,sep="")
matrix_count<-matrix(NA,ncol=3,nrow = 58)
for(i in 1:(length(filename)-1)){
text<-readLines(filename[i],warn = FALSE)
matrix_count[i,2:3]<-count(text)
}
count<-as.data.frame(matrix_count)
colnames(count)<-c("file","sentence","word")
count$file<-paste(Info$File,Info$Term)
count$var<-count$word/count$sentence
count$party<-Info$Party
date<-read.csv("date.csv")
date$Date<-as.character(date$Date)
year<-substr(date$Date,nchar(date$Date)-3,nchar(date$Date))
year<-year[year!=""]
count$year<-year
count$year<-as.numeric(count$year)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var,col="blue"))+
geom_text(x=1942,y=20,label="ww2")+
geom_text(x=1916,y=25,label="ww1")+
geom_text(x=1862,y=25,label="civil war")+
geom_text(x=1947,y=15,label="cold war start")+
geom_text(x=1991,y=15,label="cold war end")
ggplotly(p)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var,col="red"))+
geom_text(x=1837,y=37,label="Panic 1837")+
geom_text(x=1893,y=36,label="Panic 1893")+
geom_text(x=1907,y=32,label="Panic 1907")+
geom_text(x=1929,y=22,label="wall street")+
geom_text(x=2008,y=22,label="global")
ggplotly(p)
ggplot(data=count[count$party=="Republican"|count$party=="Democratic",])+
geom_boxplot(mapping = aes(x=year,y=var,col=party))
library(tm)
library(wordcloud)
library(RColorBrewer)
library(dplyr)
library(tidytext)
folder.path="../data/InauguralSpeeches/"
speeches=list.files(path = folder.path, pattern = "*.txt")
prez.out=substr(speeches, 6, nchar(speeches)-4)
length.speeches=rep(NA, length(speeches))
ff.all<-Corpus(DirSource(folder.path))
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
ff.all<-tm_map(ff.all, removeWords, character(0))
ff.all<-tm_map(ff.all, removePunctuation)
dtm<-DocumentTermMatrix(ff.all)
dtm<-as.matrix(dtm)
View(dtm)
library(xlsx)
library(qdap)
library(ggplot2)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx",1)
date<-read.csv("date.csv")
setwd("../data/InauguralSpeeches/")
count<-function(name){
n_sentence<-length(sent_detect(name))
n_word<-word_count(name)
return(c(n_sentence,n_word))
}
filename<-paste("inaug",Info$File,"-",Info$Term,".txt",collapse = NULL,sep="")
matrix_count<-matrix(NA,ncol=3,nrow = 58)
for(i in 1:(length(filename)-1)){
text<-readLines(filename[i],warn = FALSE)
matrix_count[i,2:3]<-count(text)
}
count<-as.data.frame(matrix_count)
colnames(count)<-c("file","sentence","word")
count$file<-paste(Info$File,Info$Term)
count$var<-count$word/count$sentence
count$party<-Info$Party
date$Date<-as.character(date$Date)
year<-substr(date$Date,nchar(date$Date)-3,nchar(date$Date))
year<-year[year!=""]
count$year<-year
count$year<-as.numeric(count$year)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var,col="blue"))+
geom_text(x=1942,y=20,label="ww2")+
geom_text(x=1916,y=25,label="ww1")+
geom_text(x=1862,y=25,label="civil war")+
geom_text(x=1947,y=15,label="cold war start")+
geom_text(x=1991,y=15,label="cold war end")
ggplotly(p)
p<-ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var,col="red"))+
geom_text(x=1837,y=37,label="Panic 1837")+
geom_text(x=1893,y=36,label="Panic 1893")+
geom_text(x=1907,y=32,label="Panic 1907")+
geom_text(x=1929,y=22,label="wall street")+
geom_text(x=2008,y=22,label="global")
ggplotly(p)
ggplot(data=count[count$party=="Republican"|count$party=="Democratic",])+
geom_boxplot(mapping = aes(x=year,y=var,col=party))
folder.path="../data/InauguralSpeeches/"
speeches=list.files(path = folder.path, pattern = "*.txt")
prez.out=substr(speeches, 6, nchar(speeches)-4)
length.speeches=rep(NA, length(speeches))
ff.all<-Corpus(DirSource(folder.path))
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
ff.all<-tm_map(ff.all, removeWords, character(0))
ff.all<-tm_map(ff.all, removePunctuation)
dtm<-DocumentTermMatrix(ff.all)
dtm<-as.matrix(dtm)
View(dtm)
dtm.scale<-scale(dtm)
dist<-dist(dtm.scale,method = "euclidian")
library(cluster)
hclu<-agnes(dist)
plot(hclu)
?agnes
hclu<-agnes(dist,method="complete")
plot(hclu)
dim(dtm)
party_clu<-matrix(NULL)
party_clu<-matrix(NA)
party_clu<-data.frame(NA)
name<-rownames(dtm)
party_clu$name<-substr(name,nchar(name)-3,nchar(name))
View(party_clu)
name<-rownames(dtm)
name<-substr(name,nchar(name)-3,nchar(name))
party_clu<-data.frame(name=name)
View(party_clu)
name<-rownames(dtm)
name<-substr(name,6,nchar(name)-3)
party_clu<-data.frame(name=name)
View(party_clu)
name<-rownames(dtm)
name<-substr(name,6,nchar(name)-6)
party_clu<-data.frame(name=name)
View(party_clu)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx",1)
View(Info)
party_clu<-merge(Info,party_clu,by.x="File",by.y = "name",all = TRUE)
party_clu<-party_clu[,c(1,4)]
rownames(dtm)<-party_clu$Party
View(dtm)
name<-rownames(dtm)
name<-substr(name,6,nchar(name)-6)
party_clu<-data.frame(name=name)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx",1)
party_clu<-merge(Info,party_clu,by.x="File",by.y = "name")
party_clu<-party_clu[,c(1,4)]
folder.path="../data/InauguralSpeeches/"
speeches=list.files(path = folder.path, pattern = "*.txt")
prez.out=substr(speeches, 6, nchar(speeches)-4)
length.speeches=rep(NA, length(speeches))
ff.all<-Corpus(DirSource(folder.path))
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
ff.all<-tm_map(ff.all, removeWords, character(0))
ff.all<-tm_map(ff.all, removePunctuation)
dtm<-DocumentTermMatrix(ff.all)
dtm<-as.matrix(dtm)
name<-rownames(dtm)
name<-substr(name,6,nchar(name)-6)
party_clu<-data.frame(name=name)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx",1)
party_clu<-merge(Info,party_clu,by.x="File",by.y = "name")
party_clu<-party_clu[,c(1,4)]
rownames(dtm)<-party_clu$Party
name<-rownames(dtm)
name<-substr(name,6,nchar(name)-6)
party_clu<-data.frame(name=name)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx",1)
party_clu<-merge(Info,party_clu,by.x="File",by.y = "name")
folder.path="../data/InauguralSpeeches/"
speeches=list.files(path = folder.path, pattern = "*.txt")
prez.out=substr(speeches, 6, nchar(speeches)-4)
length.speeches=rep(NA, length(speeches))
ff.all<-Corpus(DirSource(folder.path))
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
ff.all<-tm_map(ff.all, removeWords, character(0))
ff.all<-tm_map(ff.all, removePunctuation)
dtm<-DocumentTermMatrix(ff.all)
dtm<-as.matrix(dtm)
name<-rownames(dtm)
name<-substr(name,6,nchar(name)-6)
party_clu<-data.frame(name=name)
View(party_clu)
sort(Info$File)
all.equal(sort(Info$File),party_clu$name)
Info_sort<-Info[order(Info$File),]
View(Info_sort)
all.equal(Info_sort$File,party_clu$name)
party_clu$party<-Info_sort$Party
rownames(dtm)<-party_clu$party
View(dtm)
dtm.scale<-scale(dtm)
dist<-dist(dtm.scale,method="euclidian")
hclu<-agnes(dist,method="complete")
plot(hclu)
name<-rownames(dtm)
name<-substr(name,6,nchar(name)-6)
party_clu<-data.frame(name=name)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx",1)
Info_sort<-Info[order(Info$File),]
all.equal(Info_sort$File,party_clu$name)
party_clu$party<-Info_sort$Party
rownames(dtm)<-party_clu$party
dtm.scale<-scale(dtm)
dist<-dist(dtm.scale,method="euclidian")
hclu<-agnes(dist,method="complete")
plot(hclu)
date<-read.csv("date.csv")
View(date)
date$Date<-as.character(date$Date)
year<-substr(date$Date,nchar(date$Date)-3,nchar(date$Date))
year<-year[year!=""]
Info$date<-year
Info_sort<-Info[order(Info$File),]
all.equal(Info_sort$File,party_clu$name)
name<-rownames(dtm)
name<-substr(name,6,nchar(name)-6)
party_clu<-data.frame(name=name)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx",1)
date<-read.csv("date.csv")
date$Date<-as.character(date$Date)
year<-substr(date$Date,nchar(date$Date)-3,nchar(date$Date))
year<-year[year!=""]
Info$date<-year
Info_sort<-Info[order(Info$File),]
all.equal(Info_sort$File,party_clu$name)
View(Info_sort)
folder.path="../data/InauguralSpeeches/"
speeches=list.files(path = folder.path, pattern = "*.txt")
prez.out=substr(speeches, 6, nchar(speeches)-4)
length.speeches=rep(NA, length(speeches))
ff.all<-Corpus(DirSource(folder.path))
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
ff.all<-tm_map(ff.all, removeWords, character(0))
ff.all<-tm_map(ff.all, removePunctuation)
dtm<-DocumentTermMatrix(ff.all)
dtm<-as.matrix(dtm)
name<-rownames(dtm)
name<-substr(name,6,nchar(name)-6)
party_clu<-data.frame(name=name)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx",1)
date<-read.csv("date.csv")
date$Date<-as.character(date$Date)
year<-substr(date$Date,nchar(date$Date)-3,nchar(date$Date))
year<-year[year!=""]
Info$date<-year
Info_sort<-Info[order(Info$File),]
all.equal(Info_sort$File,party_clu$name)
party_clu$party<-Info_sort$Party
rownames(dtm)<-party_clu$party
dtm.scale<-scale(dtm)
dist<-dist(dtm.scale,method="euclidian")
hclu<-agnes(dist,method="complete")
plot(hclu)
year_clu<-data.frame(year=year)
View(year_clu)
View(dtm)
year_clu<-data.frame(year=Info_sort$date)
rownames(dtm)<-year_clu$year
View(dtm)
tm.scale<-scale(dtm)
dist<-dist(dtm.scale,method="euclidian")
hclu<-agnes(dist,method="complete")
plot(hclu)
year_clu<-data.frame(year=Info_sort$date)
rownames(dtm)<-year_clu$year
tm.scale<-scale(dtm)
dist<-dist(dtm.scale,method="euclidian")
hclu<-agnes(dist,method="complete")
plot(hclu)
View(dtm)
year_clu<-data.frame(year=Info_sort$date)
rownames(dtm)<-year_clu$year
dtm.scale<-scale(dtm)
dist<-dist(dtm.scale,method="euclidian")
hclu<-agnes(dist,method="complete")
plot(hclu)
year_clu<-data.frame(year=Info_sort$date)
rownames(dtm)<-year_clu$year
dtm.scale<-scale(dtm)
dist<-dist(dtm.scale,method="euclidian")
hclu<-agnes(dist,method="complete")
plot(hclu)
library(tm)
library(wordcloud)
library(RColorBrewer)
library(dplyr)
library(tidytext)
folder.path="../data/InauguralSpeeches/"
speeches=list.files(path = folder.path, pattern = "*.txt")
prez.out=substr(speeches, 6, nchar(speeches)-4)
length.speeches=rep(NA, length(speeches))
ff.all<-Corpus(DirSource(folder.path))
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
ff.all<-tm_map(ff.all, removeWords, character(0))
ff.all<-tm_map(ff.all, removePunctuation)
dtm<-DocumentTermMatrix(ff.all)
dtm<-as.matrix(dtm)
name<-rownames(dtm)
name<-substr(name,6,nchar(name)-6)
party_clu<-data.frame(name=name)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx",1)
date<-read.csv("date.csv")
date$Date<-as.character(date$Date)
year<-substr(date$Date,nchar(date$Date)-3,nchar(date$Date))
year<-year[year!=""]
Info$date<-year
Info_sort<-Info[order(Info$File),]
all.equal(Info_sort$File,party_clu$name)
party_clu$party<-Info_sort$Party
rownames(dtm)<-party_clu$party
dtm.scale<-scale(dtm)
dist<-dist(dtm.scale,method="euclidian")
hclu<-agnes(dist,method="complete")
plot(hclu)
year_clu<-data.frame(year=Info_sort$date)
rownames(dtm)<-year_clu$year
dtm.scale<-scale(dtm)
dist<-dist(dtm.scale,method="euclidian")
hclu<-agnes(dist,method="complete")
plot(hclu)
library(tm)
library(wordcloud)
library(RColorBrewer)
library(dplyr)
library(tidytext)
library(cluster)
tdm.all<-TermDocumentMatrix(ff.all)
tdm.tidy=tidy(tdm.all)
View(tdm.tidy)
tdm.overall=summarise(group_by(tdm.tidy, term), sum(count))
wordcloud(tdm.overall$term, tdm.overall$`sum(count)`,
scale=c(5,0.5),
max.words=100,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
tdm.tidy$name<-substr(tdm.tidy$document,6,nchar(tdm.tidy$document)-6)
ana_party<-merge(tdm.tidy,Info,by.x="name",by.y="File",all = TRUE)
View(ana_party)
View(tdm.tidy)
tdm.tidy$name<-substr(tdm.tidy$document,6,nchar(tdm.tidy$document)-6)
ana_party<-merge(tdm.tidy,Info,by.x="name",by.y="File")
View(ana_party)
