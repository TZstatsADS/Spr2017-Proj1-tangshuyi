library(xlsx)
library(qdap)
library(ggplot2)
setwd("../data/InauguralSpeeches/")
Info<-read.csv("InaugurationInfo.csv")
count<-function(name){
n_sentence<-length(sent_detect(name))
n_word<-word_count(name)
return(c(n_sentence,n_word))
}
filename<-paste("inaug",Info$File,"-",Info$Term,".txt",collapse = NULL,sep="")
matrix_count<-matrix(NA,ncol=3,nrow = 58)
for(i in 1:(length(filename)-1)){
text<-readLines(filename[i],warn = FALSE)
matrix_count[i,2:3]<-count(text)
}
setwd("../data/InauguralSpeeches/")
count<-function(name){
n_sentence<-length(sent_detect(name))
n_word<-word_count(name)
return(c(n_sentence,n_word))
}
filename<-paste("inaug",Info$File,"-",Info$Term,".txt",collapse = NULL,sep="")
matrix_count<-matrix(NA,ncol=3,nrow = 58)
for(i in 1:(length(filename)-1)){
text<-readLines(filename[i],warn = FALSE)
matrix_count[i,2:3]<-count(text)
}
count<-as.data.frame(matrix_count)
colnames(count)<-c("file","sentence","word")
count$file<-paste(Info$File,Info$Term)
count$var<-count$word/count$sentence
count$party<-Info$Party
date<-read.csv("date.csv")
date$Date<-as.character(date$Date)
year<-substr(date$Date,nchar(date$Date)-3,nchar(date$Date))
year<-year[year!=""]
count$year<-year
count$year<-as.numeric(count$year)
ggplot(data=count)+
geom_point(mapping = aes(x=year,y=var,col=party))+
geom_line(mapping = aes(x=year,y=var))+
geom_text(x=1942,y=20,label="ww2")+
geom_text(x=1916,y=25,label="ww1")
ggplot(data=count[count$party=="Republican"|count$party=="Democratic",])+
geom_boxplot(mapping = aes(x=year,y=var,fill=party))
ggplot(data=count[count$party=="Republican"|count$party=="Democratic",])+
geom_boxplot(mapping = aes(x=year,y=var,col=party))
ggplot(data=count[count$party=="Republican"|count$party=="Democratic",])+
geom_boxplot(mapping = aes(x=year,y=var,col=party))
library(xlsx)
library(qdap)
library(ggplot2)
setwd("../data/")
Info<-read.csv("InaugurationInfo.csv")
library(xlsx)
library(qdap)
library(ggplot2)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx")
library(xlsx)
library(qdap)
library(ggplot2)
setwd("../data/")
Info<-read.xlsx("InaugurationInfo.xlsx",1)
